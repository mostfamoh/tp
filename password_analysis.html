<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse de Complexit√© des Mots de Passe - Partie 3</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .case-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            transition: all 0.3s ease;
        }
        
        .case-card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transform: translateY(-5px);
        }
        
        .case-card.very-weak {
            border-color: #ff4444;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe5e5 100%);
        }
        
        .case-card.weak {
            border-color: #ff9800;
            background: linear-gradient(135deg, #fff8f0 0%, #ffedd5 100%);
        }
        
        .case-card.medium {
            border-color: #ffeb3b;
            background: linear-gradient(135deg, #fffef0 0%, #fff9c4 100%);
        }
        
        .case-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .case-info {
            margin: 10px 0;
        }
        
        .case-info strong {
            color: #555;
        }
        
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 15px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .results-container {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            display: none;
        }
        
        .results-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .attack-result {
            background: white;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        
        .attack-result h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .stat:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            font-weight: 600;
            color: #555;
        }
        
        .stat-value {
            color: #333;
        }
        
        .success {
            color: #4caf50;
            font-weight: bold;
        }
        
        .failed {
            color: #f44336;
            font-weight: bold;
        }
        
        .recommendations {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 30px;
        }
        
        .recommendation-category {
            margin: 25px 0;
        }
        
        .recommendation-category h3 {
            color: #2e7d32;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .recommendation-item {
            background: white;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
        
        .recommendation-item h4 {
            color: #388e3c;
            margin-bottom: 8px;
        }
        
        .recommendation-item p {
            color: #555;
            line-height: 1.6;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }
        
        .comparison-table tr:hover {
            background: #f5f5f5;
        }
        
        .security-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .security-badge.tres-dangereux {
            background: #ff4444;
            color: white;
        }
        
        .security-badge.dangereux {
            background: #ff9800;
            color: white;
        }
        
        .security-badge.faible {
            background: #ffeb3b;
            color: #333;
        }
        
        .security-badge.moyen {
            background: #4caf50;
            color: white;
        }
        
        .security-badge.fort {
            background: #2196f3;
            color: white;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîí Analyse de Complexit√© des Mots de Passe</h1>
            <p>Partie 3 : √âvaluation de la s√©curit√© et simulation d'attaques</p>
        </header>
        
        <div class="content">
            <div class="section">
                <h2 class="section-title">üìä Cas de Test</h2>
                <div class="cases-grid">
                    <div class="case-card very-weak">
                        <div class="case-title">Cas 1 : Tr√®s Faible</div>
                        <div class="case-info"><strong>Description:</strong> 3 caract√®res parmi {0, 1, 2}</div>
                        <div class="case-info"><strong>Charset:</strong> 012</div>
                        <div class="case-info"><strong>Longueur:</strong> 3</div>
                        <div class="case-info"><strong>Espace de cl√©s:</strong> 27</div>
                        <button class="test-button" onclick="testCase('case1', '012')">
                            Tester ce cas
                        </button>
                        <div id="result-case1" class="results-container"></div>
                    </div>
                    
                    <div class="case-card weak">
                        <div class="case-title">Cas 2 : Faible</div>
                        <div class="case-info"><strong>Description:</strong> 6 caract√®res num√©riques (0-9)</div>
                        <div class="case-info"><strong>Charset:</strong> 0123456789</div>
                        <div class="case-info"><strong>Longueur:</strong> 6</div>
                        <div class="case-info"><strong>Espace de cl√©s:</strong> 1,000,000</div>
                        <button class="test-button" onclick="testCase('case2', '123456')">
                            Tester ce cas
                        </button>
                        <div id="result-case2" class="results-container"></div>
                    </div>
                    
                    <div class="case-card medium">
                        <div class="case-title">Cas 3 : Moyen</div>
                        <div class="case-info"><strong>Description:</strong> 6 caract√®res alphanum√©riques + sp√©ciaux</div>
                        <div class="case-info"><strong>Charset:</strong> a-z, A-Z, 0-9, !@#$%...</div>
                        <div class="case-info"><strong>Longueur:</strong> 6</div>
                        <div class="case-info"><strong>Espace de cl√©s:</strong> ~690 milliards</div>
                        <button class="test-button" onclick="testCase('case3', 'aB3!xY')">
                            Tester ce cas
                        </button>
                        <div id="result-case3" class="results-container"></div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">üõ°Ô∏è Recommandations de Protection</h2>
                <button class="test-button" onclick="loadRecommendations()">
                    Afficher les recommandations
                </button>
                <div id="recommendations-content"></div>
            </div>
            
            <div class="section">
                <h2 class="section-title">‚öñÔ∏è Comparaison des Temps de Craquage</h2>
                <p style="margin-bottom: 20px;">Estimations bas√©es sur 100 milliards de tentatives/seconde (GPU moderne)</p>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Mot de passe</th>
                            <th>Espace de cl√©s</th>
                            <th>Temps de craquage</th>
                            <th>Niveau de s√©curit√©</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>012</code> (Cas 1)</td>
                            <td>27</td>
                            <td>&lt; 1 microseconde</td>
                            <td><span class="security-badge tres-dangereux">TR√àS DANGEREUX</span></td>
                        </tr>
                        <tr>
                            <td><code>123456</code> (Cas 2)</td>
                            <td>1,000,000</td>
                            <td>&lt; 1 milliseconde</td>
                            <td><span class="security-badge tres-dangereux">TR√àS DANGEREUX</span></td>
                        </tr>
                        <tr>
                            <td><code>aB3!xY</code> (Cas 3)</td>
                            <td>~735 milliards</td>
                            <td>~2 heures</td>
                            <td><span class="security-badge faible">FAIBLE</span></td>
                        </tr>
                        <tr>
                            <td><code>aB3!xY9$Qm</code> (10 chars)</td>
                            <td>~6 √ó 10<sup>19</sup></td>
                            <td>~19 ans</td>
                            <td><span class="security-badge moyen">MOYEN</span></td>
                        </tr>
                        <tr>
                            <td><code>aB3!xY9$Qm7&</code> (12 chars)</td>
                            <td>~5 √ó 10<sup>23</sup></td>
                            <td>~160,000 ans</td>
                            <td><span class="security-badge fort">FORT</span></td>
                        </tr>
                        <tr>
                            <td>Avec Argon2id (m√™me "123456")</td>
                            <td>1,000,000</td>
                            <td>~58 jours (avec rate limiting)</td>
                            <td><span class="security-badge moyen">ACCEPTABLE</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        function testCase(caseId, password) {
            const resultDiv = document.getElementById(`result-${caseId}`);
            resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;"><div class="loading"></div> Analyse en cours...</div>';
            resultDiv.classList.add('show');
            
            fetch('/api/crypto_lab/password-analysis/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    case_id: caseId,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    resultDiv.innerHTML = `<div style="color: red;">Erreur: ${data.error}</div>`;
                    return;
                }
                
                let html = `<h3>R√©sultats du test pour "${data.test_password}"</h3>`;
                
                // Brute Force Attack
                if (data.attacks.brute_force) {
                    const bf = data.attacks.brute_force;
                    html += `
                        <div class="attack-result">
                            <h4>‚öîÔ∏è Attaque par Force Brute</h4>
                            <div class="stat">
                                <span class="stat-label">Statut:</span>
                                <span class="stat-value ${bf.success ? 'success' : 'failed'}">
                                    ${bf.success ? '‚úÖ SUCC√àS' : '‚ùå √âCHEC'}
                                </span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Tentatives:</span>
                                <span class="stat-value">${bf.attempts.toLocaleString()}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Temps √©coul√©:</span>
                                <span class="stat-value">${formatTime(bf.time_seconds)}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Vitesse:</span>
                                <span class="stat-value">${bf.attempts_per_second.toLocaleString()} tentatives/sec</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Espace explor√©:</span>
                                <span class="stat-value">${bf.percentage_searched}%</span>
                            </div>
                    `;
                    
                    if (bf.estimated_full_keyspace_time) {
                        const est = bf.estimated_full_keyspace_time;
                        html += `
                            <div class="stat">
                                <span class="stat-label">Temps estim√© (espace complet):</span>
                                <span class="stat-value">
                                    ${est.years ? est.years.toLocaleString() + ' ann√©es' : 
                                      est.days ? est.days.toLocaleString() + ' jours' :
                                      est.hours ? est.hours.toLocaleString() + ' heures' :
                                      est.minutes.toLocaleString() + ' minutes'}
                                </span>
                            </div>
                        `;
                    }
                    
                    html += '</div>';
                }
                
                // Dictionary Attack
                if (data.attacks.dictionary) {
                    const da = data.attacks.dictionary;
                    html += `
                        <div class="attack-result">
                            <h4>üìñ Attaque par Dictionnaire</h4>
                            <div class="stat">
                                <span class="stat-label">Statut:</span>
                                <span class="stat-value ${da.success ? 'success' : 'failed'}">
                                    ${da.success ? '‚úÖ SUCC√àS' : '‚ùå √âCHEC'}
                                </span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Taille du dictionnaire:</span>
                                <span class="stat-value">${da.dictionary_size.toLocaleString()}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Tentatives:</span>
                                <span class="stat-value">${da.attempts.toLocaleString()}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Temps √©coul√©:</span>
                                <span class="stat-value">${formatTime(da.time_seconds)}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Vitesse:</span>
                                <span class="stat-value">${da.attempts_per_second.toLocaleString()} tentatives/sec</span>
                            </div>
                        </div>
                    `;
                }
                
                resultDiv.innerHTML = html;
            })
            .catch(error => {
                resultDiv.innerHTML = `<div style="color: red;">Erreur: ${error.message}</div>`;
            });
        }
        
        function formatTime(seconds) {
            if (seconds < 0.001) {
                return `${(seconds * 1000000).toFixed(2)} Œºs`;
            } else if (seconds < 1) {
                return `${(seconds * 1000).toFixed(2)} ms`;
            } else if (seconds < 60) {
                return `${seconds.toFixed(2)} secondes`;
            } else if (seconds < 3600) {
                return `${(seconds / 60).toFixed(2)} minutes`;
            } else {
                return `${(seconds / 3600).toFixed(2)} heures`;
            }
        }
        
        function loadRecommendations() {
            const container = document.getElementById('recommendations-content');
            container.innerHTML = '<div style="text-align: center; padding: 20px;"><div class="loading"></div> Chargement...</div>';
            
            fetch('/api/crypto_lab/password-protection/')
            .then(response => response.json())
            .then(data => {
                let html = '<div class="recommendations">';
                
                data.categories.forEach(category => {
                    html += `<div class="recommendation-category">`;
                    html += `<h3>${category.category}</h3>`;
                    
                    category.recommendations.forEach(rec => {
                        html += `<div class="recommendation-item">`;
                        html += `<h4>‚úì ${rec.recommendation}</h4>`;
                        html += `<p>${rec.description}</p>`;
                        if (rec.implementation) {
                            html += `<p style="margin-top: 8px;"><strong>üí° Impl√©mentation:</strong> ${rec.implementation}</p>`;
                        }
                        if (rec.impact) {
                            html += `<p style="margin-top: 8px;"><strong>üí• Impact:</strong> ${rec.impact}</p>`;
                        }
                        html += `</div>`;
                    });
                    
                    html += `</div>`;
                });
                
                html += '</div>';
                container.innerHTML = html;
            })
            .catch(error => {
                container.innerHTML = `<div style="color: red;">Erreur: ${error.message}</div>`;
            });
        }
    </script>
</body>
</html>
